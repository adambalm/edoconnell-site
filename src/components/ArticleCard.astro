---
/**
 * ArticleCard â€” card component for article listing pages.
 *
 * Gradient-border hover effect, kind badge, abstract preview, tags.
 */
import { stegaClean } from '@sanity/client/stega'

interface Props {
  article: {
    title: string
    slug: { current: string }
    kind?: string
    abstract?: string
    tags?: string[]
    provenance?: { date?: string }
  }
}

const { article } = Astro.props
const kind = stegaClean(article.kind)

const kindLabels: Record<string, string> = {
  brief: 'Brief',
  essay: 'Essay',
  'case-study': 'Case Study',
}
---

<a href={`/articles/${article.slug.current}/`} class="article-card" data-kind={kind}>
  <div class="card-body">
    <div class="card-header">
      <h2 class="card-title">{article.title}</h2>
      {kind && (
        <span class="card-kind">{kindLabels[kind] || kind}</span>
      )}
    </div>
    {article.abstract && (
      <p class="card-abstract">{article.abstract}</p>
    )}
    <div class="card-footer">
      {article.provenance?.date && (
        <time class="card-date">{article.provenance.date}</time>
      )}
      {article.tags && article.tags.length > 0 && (
        <ul class="card-tags" aria-label="Tags">
          {article.tags.map((tag: string) => <li>{tag}</li>)}
        </ul>
      )}
    </div>
  </div>
</a>

<style>
  .article-card {
    display: block;
    position: relative;
    padding: var(--space-6);
    border: 1px solid var(--color-border);
    border-left: 3px solid var(--color-border);
    border-radius: 8px;
    text-decoration: none;
    color: inherit;
    background: var(--color-surface, var(--color-bg));
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
  }

  .article-card[data-kind="brief"] {
    border-left-color: var(--color-kind-brief);
  }

  .article-card[data-kind="essay"] {
    border-left-color: var(--color-kind-essay);
  }

  .article-card[data-kind="case-study"] {
    border-left-color: var(--color-kind-case-study);
  }

  .article-card:hover {
    border-color: var(--color-accent);
    box-shadow: 0 0 0 1px var(--color-accent);
  }

  .article-card[data-kind="brief"]:hover {
    border-left-color: var(--color-kind-brief);
  }

  .article-card[data-kind="essay"]:hover {
    border-left-color: var(--color-kind-essay);
  }

  .article-card[data-kind="case-study"]:hover {
    border-left-color: var(--color-kind-case-study);
  }

  .card-body {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
  }

  .card-header {
    display: flex;
    align-items: baseline;
    gap: var(--space-3);
    flex-wrap: wrap;
  }

  .card-title {
    font-family: var(--font-ui);
    font-size: var(--font-size-xl);
    font-weight: 600;
    color: var(--color-text);
    margin: 0;
    line-height: var(--leading-tight);
  }

  .article-card:hover .card-title {
    color: var(--color-accent);
  }

  .card-kind {
    font-family: var(--font-ui);
    font-size: var(--font-size-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    padding: 0.15em 0.6em;
    border-radius: 3px;
    background: var(--color-accent-subtle, rgba(139, 38, 53, 0.06));
    color: var(--color-accent);
    white-space: nowrap;
  }

  .article-card[data-kind="brief"] .card-kind {
    background: var(--color-kind-brief-subtle);
    color: var(--color-kind-brief);
  }

  .article-card[data-kind="essay"] .card-kind {
    background: var(--color-kind-essay-subtle);
    color: var(--color-kind-essay);
  }

  .article-card[data-kind="case-study"] .card-kind {
    background: var(--color-kind-case-study-subtle);
    color: var(--color-kind-case-study);
  }

  .card-abstract {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    line-height: var(--leading-normal);
    margin: 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    max-width: var(--measure);
  }

  .card-footer {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    flex-wrap: wrap;
    margin-top: var(--space-1);
  }

  .card-date {
    font-family: var(--font-ui);
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
  }

  .card-tags {
    display: flex;
    gap: var(--space-2);
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .card-tags li {
    font-family: var(--font-ui);
    font-size: var(--font-size-xs);
    padding: 0.1em 0.5em;
    background: var(--color-bg-subtle);
    border-radius: 3px;
    color: var(--color-text-muted);
  }
</style>
